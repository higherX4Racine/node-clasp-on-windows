<script type="module">
    import { computed, createApp, ref } from "https://unpkg.com/vue@3/dist/vue.esm-browser.js";

    createApp({
        setup() {
            // a counter modifiable by buttons
            const counter = ref(0);

            const message = ref("Hello, world!");

            const titleClass = ref("title");

            function increment(e) {
                counter.value++;
            };

            function decrement(e) {
                counter.value--;
            };

            // a paragraph element connected to a text input
            const modelText = ref("");

            // a toggle button for demonstrating if-else behavior
            const affirm = ref(false);

            function toggle(e) {
                affirm.value = !affirm.value;
            }

            // a to-do list that demonstrates for behavior
            let id = 0;

            const todos = ref([]);

            const newTodo = ref("");

            const hideCompleted = ref(false);

            const filteredTodos = computed(() => {
                if( hideCompleted.value) {
                    return todos.value.filter((item) => !item.done);
                }
                return todos.value;
            });

            function addTodo(todoText) {
                todos.value.push({
                    id: id++,
                    text: todoText,
                    done: false
                });
            };

            function removeTodo(todo) {
                todos.value.splice(
                    todos.value.indexOf(todo),
                    1
                );
            };

            [
                "Learn Google Apps Script",
                "Learn Vue",
                "Integrate them"
            ].map(addTodo);

            return {
                counter,
                message,
                titleClass,
                increment,
                decrement,
                modelText,
                affirm,
                toggle,
                todos,
                newTodo,
                hideCompleted,
                filteredTodos,
                addTodo,
                removeTodo
            };
        }
    }).mount("#app")
</script>

<style>
    .title {
        color: #012288;
    }

    .delete-remove {
        color: #ff1111;
    }

    .done {
        text-decoration: line-through;
    }
</style>

<div id="app">
    <h1 :class="titleClass">{{ message }}</h1>
    <div id="counter">
        <h2>A counter</h2>
        <span>
            <button @click="increment">Increase</button>
            <button @click="decrement">Decrease</button>
        </span>
        <p>count is: {{ counter }}</p>
    </div>
    <div id="text-model">
        <h2>A text input</h2>
        <input v-model="modelText" placeholder="Type here, please.">
        <p>{{ modelText }}</p>
    </div>
    <div id="toggle-if">
        <h2>A toggle button</h2>
        <button @click="toggle">{{ affirm ? "deactivate" : "activate" }}</button>
        <h3 v-if="affirm">The toggle is on.</h3>
        <h3 v-else=>The toggle is off.</h3>
    </div>
    <div id="todo-list">
        <h2>A to-do list</h2>
        <form @submit.prevent="addTodo(newTodo)">
            <input v-model="newTodo">
            <button>Add To-do</button>
        </form>
        <ul>
            <li v-for="todo in filteredTodos" :key="todo.id">
                <input type="checkbox" v-model="todo.done">
                <span :class="{ done: todo.done }">{{ todo.text }}</span>
                <button @click="removeTodo(todo)" class="delete-remove">X</button>
            </li>
        </ul>
        <button @click="hideCompleted = !hideCompleted">
            {{ hideCompleted ? 'Show all' : 'Hide completed' }}
        </button>
    </div>
</div>